[gd_scene load_steps=20 format=4 uid="uid://f4ofdiq71cn8"]

[ext_resource type="PackedScene" uid="uid://d3w3bugoejq75" path="res://world/miner/miner.tscn" id="1_6xmxd"]
[ext_resource type="Script" uid="uid://bybjw7chkiasm" path="res://world/world.gd" id="1_fn3g3"]
[ext_resource type="PackedScene" uid="uid://cden776bhu3x1" path="res://world/walls/stone_wall.tscn" id="2_tcf2h"]
[ext_resource type="PackedScene" uid="uid://cekf6rmx2iwnc" path="res://world/lift/lift.tscn" id="3_4717r"]
[ext_resource type="Texture2D" uid="uid://cadl6oghhf5kb" path="res://world/level/stone_wall.png" id="4_h5o24"]
[ext_resource type="PackedScene" uid="uid://obevqtjw032c" path="res://world/level/background/background.tscn" id="5_mmdvd"]
[ext_resource type="Script" uid="uid://csugsxsl57eb7" path="res://world/walls/stone_wall.gd" id="7_sc4t8"]
[ext_resource type="Script" uid="uid://bnenrhnd2iy8y" path="res://world/upgrades/upgrade_manager.gd" id="8_ai45w"]
[ext_resource type="Script" uid="uid://dej32wcn7n0xq" path="res://world/upgrades/upgrade_data.gd" id="9_fyhu2"]
[ext_resource type="Resource" uid="uid://cmyrusajtotst" path="res://world/upgrades/data/movement_speed_upgrade.tres" id="10_ov2xu"]
[ext_resource type="Resource" uid="uid://b3cluq2j01m1a" path="res://world/upgrades/data/damage_upgrade.tres" id="11_ov2xu"]
[ext_resource type="Resource" uid="uid://de21jbwr1sppu" path="res://world/upgrades/data/max_hits_upgrade.tres" id="12_ocfjn"]
[ext_resource type="Resource" uid="uid://0at7c5hsjq8o" path="res://world/upgrades/data/mining_speed_upgrade.tres" id="13_dqqhb"]
[ext_resource type="Resource" uid="uid://fkdd8ratwgub" path="res://world/upgrades/data/lift_speed_upgrade.tres" id="14_dqqhb"]

[sub_resource type="TileSetAtlasSource" id="TileSetAtlasSource_h5o24"]
texture = ExtResource("4_h5o24")
0:0/0 = 0
1:0/0 = 0
2:0/0 = 0
3:0/0 = 0
4:0/0 = 0
5:0/0 = 0
0:1/0 = 0
2:1/0 = 0
3:1/0 = 0
5:1/0 = 0
0:2/0 = 0
1:2/0 = 0
2:2/0 = 0
3:2/0 = 0
4:2/0 = 0
5:2/0 = 0
6:0/0 = 0

[sub_resource type="TileSet" id="TileSet_4717r"]
sources/1 = SubResource("TileSetAtlasSource_h5o24")

[sub_resource type="RectangleShape2D" id="RectangleShape2D_mmdvd"]
size = Vector2(32, 4)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_fn3g3"]
size = Vector2(32, 4)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_sc4t8"]
size = Vector2(32, 4)

[node name="World" type="Node2D"]
script = ExtResource("1_fn3g3")

[node name="Background" parent="." instance=ExtResource("5_mmdvd")]
position = Vector2(160, 88)

[node name="Level" type="TileMapLayer" parent="."]
position = Vector2(0, -16)
tile_map_data = PackedByteArray("AAACAAsAAQABAAAAAAADAAsAAQABAAAAAAAEAAsAAQABAAAAAAAFAAsAAQABAAAAAAAGAAsAAQABAAAAAAAHAAsAAQABAAAAAAAIAAsAAQABAAAAAAAJAAsAAQABAAAAAAAKAAsAAQABAAAAAAALAAsAAQABAAAAAAAMAAsAAQABAAAAAAANAAsAAQAEAAIAAAAOAAsAAQAEAAIAAAAPAAsAAQAEAAIAAAAQAAsAAQAEAAIAAAARAAsAAQAEAAIAAAASAAsAAQAEAAIAAAATAAsAAQAFAAIAAAATAAoAAQAAAAEAAAATAAkAAQAAAAEAAAABAAsAAQABAAAAAAAAAAsAAQABAAAAAAATAAgAAQAAAAEAAAATAAcAAQAAAAEAAAATAAYAAQAAAAEAAAATAAUAAQAAAAEAAAATAAQAAQAAAAEAAAATAAMAAQAAAAEAAAATAAIAAQAAAAEAAAASAAEAAQAEAAAAAAARAAEAAQAEAAAAAAAQAAEAAQAEAAAAAAAPAAEAAQAEAAAAAAAOAAEAAQAEAAAAAAANAAEAAQAEAAAAAAAMAAEAAQAEAAAAAAALAAEAAQAEAAAAAAAKAAEAAQAEAAAAAAAJAAEAAQAEAAAAAAAIAAEAAQAEAAAAAAAHAAEAAQAEAAAAAAAGAAEAAQAEAAAAAAAFAAEAAQAEAAAAAAAEAAEAAQAEAAAAAAADAAEAAQAEAAAAAAACAAEAAQAEAAAAAAATAAEAAQAFAAAAAAAAAAwAAQAGAAAAAAABAAwAAQAGAAAAAAACAAwAAQAGAAAAAAADAAwAAQAGAAAAAAAEAAwAAQAGAAAAAAAFAAwAAQAGAAAAAAAGAAwAAQAGAAAAAAAHAAwAAQAGAAAAAAAIAAwAAQAGAAAAAAAJAAwAAQAGAAAAAAAKAAwAAQAGAAAAAAALAAwAAQAGAAAAAAAMAAwAAQAGAAAAAAANAAwAAQAGAAAAAAAOAAwAAQAGAAAAAAAPAAwAAQAGAAAAAAAQAAwAAQAGAAAAAAARAAwAAQAGAAAAAAASAAwAAQAGAAAAAAATAAwAAQAGAAAAAAA=")
tile_set = SubResource("TileSet_4717r")

[node name="Lift" parent="." instance=ExtResource("3_4717r")]
position = Vector2(16, 144)
collision_mask = 4

[node name="Miner" parent="." instance=ExtResource("1_6xmxd")]
position = Vector2(60, 160)
collision_layer = 4
collision_mask = 0

[node name="LiftStopers" type="Node" parent="."]

[node name="LiftStoperUp" type="Area2D" parent="LiftStopers"]
collision_layer = 2

[node name="CollisionShape2D" type="CollisionShape2D" parent="LiftStopers/LiftStoperUp"]
position = Vector2(16, -6)
shape = SubResource("RectangleShape2D_mmdvd")

[node name="LiftStoperDown" type="Area2D" parent="LiftStopers"]
collision_layer = 2

[node name="CollisionShape2D" type="CollisionShape2D" parent="LiftStopers/LiftStoperDown"]
position = Vector2(16, 162)
shape = SubResource("RectangleShape2D_fn3g3")

[node name="PlayerStopers" type="Node" parent="."]

[node name="StoneWall" parent="PlayerStopers" instance=ExtResource("2_tcf2h")]
position = Vector2(312, 0)
collision_layer = 8
collision_mask = 4
script = ExtResource("7_sc4t8")

[node name="PlayerStoperLift" type="Area2D" parent="PlayerStopers"]
collision_layer = 8
collision_mask = 4

[node name="CollisionShape2D" type="CollisionShape2D" parent="PlayerStopers/PlayerStoperLift"]
position = Vector2(16, 158)
shape = SubResource("RectangleShape2D_sc4t8")

[node name="UpgradeManager" type="Node" parent="."]
script = ExtResource("8_ai45w")
upgrades = Array[ExtResource("9_fyhu2")]([ExtResource("10_ov2xu"), ExtResource("11_ov2xu"), ExtResource("13_dqqhb"), ExtResource("12_ocfjn"), ExtResource("14_dqqhb")])

[connection signal="ready_to_load" from="Lift" to="Miner" method="_on_lift_ready_to_load"]
[connection signal="unloaded" from="Lift" to="." method="_on_lift_unloaded"]
[connection signal="damage_dealt" from="Miner" to="PlayerStopers/StoneWall" method="_on_miner_damage_dealt"]
[connection signal="loot_dumped" from="Miner" to="Lift" method="_on_miner_loot_dumped"]
[connection signal="request_lift_ready" from="Miner" to="Lift" method="_on_miner_request_lift_ready"]
[connection signal="area_entered" from="LiftStopers/LiftStoperUp" to="Lift" method="_on_lift_stoper_up_area_entered"]
[connection signal="area_entered" from="LiftStopers/LiftStoperDown" to="Lift" method="_on_lift_stoper_down_area_entered"]
[connection signal="area_entered" from="PlayerStopers/StoneWall" to="Miner" method="_on_stone_wall_area_entered"]
[connection signal="stone_dropped" from="PlayerStopers/StoneWall" to="Miner" method="_on_stone_wall_stone_dropped"]
[connection signal="area_entered" from="PlayerStopers/PlayerStoperLift" to="Miner" method="_on_player_stoper_lift_area_entered"]
[connection signal="miner_upgrade_applied" from="UpgradeManager" to="Miner" method="_on_upgrade_manager_miner_upgrade_applied"]
